<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>MFC课程设计以及对xml文件的操作 | 指尖魔法屋</title>

    
    <meta name="description" content="">
    <meta name="keywords" content="MFC">

    
    <meta property="og:title" content="MFC课程设计以及对xml文件的操作">
    <meta property="og:description" content="">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://example.org/post/534_mfc%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E4%BB%A5%E5%8F%8A%E5%AF%B9xml%E6%96%87%E4%BB%B6%E7%9A%84%E6%93%8D%E4%BD%9C/">
    

    
    <link rel="icon" href="https://example.org/favicon.ico">

    
    <link rel="stylesheet" href="/css/reset.css">
    <link rel="stylesheet" href="/css/github-markdown.css">
    <link rel="stylesheet" href="/css/custom.css">
</head>
<body>
    
    
    <nav class="top-menu">
        <div class="container">
            <div class="left">
                <a href="https://example.org/">指尖魔法屋</a>
            </div>
            <ul class="menu">
                <li class="">
                    <a href="https://example.org/">首页</a>
                </li>
                <li class="">
                    <a href="https://example.org/categories/">分类</a>
                </li>
                <li class="">
                    <a href="https://example.org/tags/">标签</a>
                </li>
            </ul>
            <div class="right">
                <a href="/admin" class="admin-link">
                    <span>登录</span>
                </a>
            </div>
        </div>
    </nav>
    

    
    <main>
        
<div class="article-content">
    <div class="markdown-body">
        <p>废话不说，进入正题，<code>为了简便请调整项目属性为使用多字节字符集</code></p>
<blockquote>
<p>tinyxml文件下载地址，（操作xml文件的）</p>
</blockquote>
<p><a href="http://sourceforge.net/projects/tinyxml/">http://sourceforge.net/projects/tinyxml/</a></p>
<h2 id="一些函数功能">一些函数功能</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">ValueStr</span>     <span class="c1">//返回元素名称
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">SetValue</span>     <span class="c1">//设置元素名称
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">Parent</span>     <span class="c1">//返回父节点对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">FirstChild</span>    <span class="c1">//返回第一个子节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">LastChild</span>     <span class="c1">//返回最后一个子节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">IterateChildren</span>   <span class="c1">//返回下一个子节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">InsertEndChild</span>   <span class="c1">//在最后一个子节点后插入子节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">InsertBeforeChild</span>   <span class="c1">//在指定的子节点前插入子节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">InsertAfterChild</span>   <span class="c1">//在指定的子节点后插入子节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">ReplaceChild</span>    <span class="c1">//替换指定的子节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">RemoveChild</span>    <span class="c1">//删除指定的子节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">Clear</span>     <span class="c1">//删除所有的子节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">PreviousSibling</span>   <span class="c1">//返回同级中前一个节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">NextSibling</span>    <span class="c1">//返回同级中后一个节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">NextSiblingElement</span>   <span class="c1">//返回同级中后一个元素
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">FirstChildElement</span>   <span class="c1">//返回第一个子元素节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">Attribute</span>     <span class="c1">//返回元素中的属性值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">QueryValueAttribute</span> <span class="c1">//返回元素中的属性值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">SetAttribute</span>    <span class="c1">//设置元素中的属性值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">FirstAttribute</span>   <span class="c1">//返回元素中第一个属性对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">LastAttribute</span>    <span class="c1">//返回元素中最后一个属性对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">RemoveAttribute</span>   <span class="c1">//删除元素中指定的属性对象
</span></span></span></code></pre></div><h2 id="tinyxml的添加">tinyxml的添加</h2>
<p>首先，将下载的文件解压复制到原项目目录，</p>
<p>然后，在解决方案中头文件添加现有项，添加进去。</p>
<h2 id="接下来在stdafxh中包含两个头文件">接下来，在stdafx.h中包含两个头文件。</h2>
<h2 id="mfc中xml文件的使用">mfc中xml文件的使用</h2>
<ul>
<li>
<p>第一步：建立对话框，添加CString变量（与编辑框关联起来).</p>
</li>
<li>
<p>第二步，（信息录入）添加按钮处理消息（双击按钮即可），利用UpdataeData（）更新数据，将数据录入xml文件。</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">TiXmlDocument</span> <span class="o">*</span><span class="nx">pDoc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TiXmlDocument</span><span class="p">();</span><span class="c1">//文件指针
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">	<span class="kr">const</span> <span class="kr">char</span> <span class="o">*</span><span class="nx">FileName</span> <span class="o">=</span> <span class="s2">&#34;res\\Number.xml&#34;</span><span class="p">;</span><span class="c1">//文件名
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">pDoc</span><span class="o">-&gt;</span><span class="nx">LoadFile</span><span class="p">(</span><span class="nx">FileName</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">UpdateData</span><span class="p">(</span><span class="nx">TRUE</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">TiXmlElement</span> <span class="o">*</span><span class="nx">RootElement</span> <span class="o">=</span> <span class="nx">NULL</span><span class="p">;</span><span class="c1">//根节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">		<span class="nx">TiXmlElement</span> <span class="o">*</span><span class="nx">PersonElement</span> <span class="o">=</span> <span class="nx">NULL</span><span class="p">;</span><span class="c1">//子节点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">TiXmlDeclaration</span> <span class="o">*</span><span class="nx">pTd</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TiXmlDeclaration</span><span class="p">(</span><span class="s2">&#34;1.0&#34;</span><span class="p">,</span> <span class="s2">&#34;gb2312&#34;</span><span class="p">,</span> <span class="s2">&#34;yes&#34;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">pDoc</span><span class="o">-&gt;</span><span class="nx">LinkEndChild</span><span class="p">(</span><span class="nx">pTd</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">RootElement</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TiXmlElement</span><span class="p">(</span><span class="s2">&#34;账号数据&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">pDoc</span><span class="o">-&gt;</span><span class="nx">LinkEndChild</span><span class="p">(</span><span class="nx">RootElement</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="nx">RootElement</span> <span class="o">=</span> <span class="nx">pDoc</span><span class="o">-&gt;</span><span class="nx">RootElement</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">              <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">PersonElement</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TiXmlElement</span><span class="p">(</span><span class="s2">&#34;用户&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">RootElement</span><span class="o">-&gt;</span><span class="nx">LinkEndChild</span><span class="p">(</span><span class="nx">PersonElement</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">TiXmlElement</span> <span class="o">*</span><span class="nx">NameElement</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TiXmlElement</span><span class="p">(</span><span class="s2">&#34;账号&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">PersonElement</span><span class="o">-&gt;</span><span class="nx">LinkEndChild</span><span class="p">(</span><span class="nx">NameElement</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">TiXmlText</span> <span class="o">*</span><span class="nb">Number</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TiXmlText</span><span class="p">([</span><span class="nx">要存的数据</span><span class="p">]);</span><span class="c1">//存的数据可为CString类型
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">		<span class="nx">NameElement</span><span class="o">-&gt;</span><span class="nx">LinkEndChild</span><span class="p">(</span><span class="nb">Number</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">TiXmlElement</span> <span class="o">*</span><span class="nx">PassWordElement</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TiXmlElement</span><span class="p">(</span><span class="s2">&#34;密码&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">PersonElement</span><span class="o">-&gt;</span><span class="nx">LinkEndChild</span><span class="p">(</span><span class="nx">PassWordElement</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">TiXmlText</span> <span class="o">*</span><span class="nx">PassWord</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TiXmlText</span><span class="p">([</span><span class="nx">要存的数据</span><span class="p">]);</span><span class="c1">//存的数据可为CString类型
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">		<span class="nx">PassWordElement</span><span class="o">-&gt;</span><span class="nx">LinkEndChild</span><span class="p">(</span><span class="nx">PassWord</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="c1">//你有几项就弄几段上面的代码，本例为两项数据
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">                <span class="nx">pDoc</span><span class="o">-&gt;</span><span class="nx">SaveFile</span><span class="p">(</span><span class="nx">FileName</span><span class="p">);</span>
</span></span></code></pre></div><ul>
<li>第三步，（信息显示）先添加list control 控件，选择report（报表）属性，同时添加变量m_ctllist1选择control类型（默认）。</li>
</ul>
<p>然后在OnInitDialog(void)函数中添加如下代码</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">DWORD</span> <span class="nx">dwStyle</span> <span class="o">=</span> <span class="nx">m_ctllist1</span><span class="p">.</span><span class="nx">GetExtendedStyle</span><span class="p">();</span>                    <span class="c1">//添加列表框的网格线！！！
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">dwStyle</span> <span class="o">|=</span> <span class="nx">LVS_EX_FULLROWSELECT</span><span class="p">;</span>            
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">dwStyle</span> <span class="o">|=</span> <span class="nx">LVS_EX_GRIDLINES</span><span class="p">;</span>                
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">m_ctllist1</span><span class="p">.</span><span class="nx">SetExtendedStyle</span><span class="p">(</span><span class="nx">dwStyle</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">//list control 的初始化
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">	<span class="nx">m_ctllist1</span><span class="p">.</span><span class="nx">InsertColumn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&#34;车牌&#34;</span><span class="p">,</span><span class="nx">LVCFMT_CENTER</span><span class="p">,</span><span class="mi">80</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">m_ctllist1</span><span class="p">.</span><span class="nx">InsertColumn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&#34;进入时间&#34;</span><span class="p">,</span><span class="nx">LVCFMT_CENTER</span><span class="p">,</span><span class="mi">120</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">m_ctllist1</span><span class="p">.</span><span class="nx">InsertColumn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&#34;停车时间&#34;</span><span class="p">,</span><span class="nx">LVCFMT_CENTER</span><span class="p">,</span><span class="mi">120</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">m_ctllist1</span><span class="p">.</span><span class="nx">InsertColumn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s2">&#34;应缴费用&#34;</span><span class="p">,</span><span class="nx">LVCFMT_CENTER</span><span class="p">,</span><span class="mi">100</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">m_ctllist1</span><span class="p">.</span><span class="nx">InsertColumn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s2">&#34;备注&#34;</span><span class="p">,</span><span class="nx">LVCFMT_CENTER</span><span class="p">,</span><span class="mi">220</span><span class="p">);</span>
</span></span></code></pre></div><p>数值为长度，如未发现此函数，请在类向导中虚函数添加该函数。运行效果如下</p>
<p>然后添加刷新按钮事件处理程序</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">TiXmlDocument</span> <span class="o">*</span> <span class="nx">myDocument</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TiXmlDocument</span><span class="p">();</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">myDocument</span><span class="o">-&gt;</span><span class="nx">LoadFile</span><span class="p">(</span><span class="s2">&#34;res\\Number.xml&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">TiXmlElement</span> <span class="o">*</span><span class="nx">RootElement</span> <span class="o">=</span> <span class="nx">myDocument</span><span class="o">-&gt;</span><span class="nx">RootElement</span><span class="p">();</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">TiXmlElement</span> <span class="o">*</span><span class="nx">FirstElement</span> <span class="o">=</span> <span class="nx">RootElement</span><span class="o">-&gt;</span><span class="nx">FirstChildElement</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">//循环遍历
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="p">(</span><span class="kr">int</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nx">FirstElement</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">TiXmlElement</span> <span class="o">*</span><span class="nx">NameElement</span> <span class="o">=</span> <span class="nx">FirstElement</span><span class="o">-&gt;</span><span class="nx">FirstChildElement</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">m_ctllist1</span><span class="p">.</span><span class="nx">InsertItem</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="nx">NameElement</span><span class="o">-&gt;</span><span class="nx">GetText</span><span class="p">());</span><span class="c1">//设置列表框第0行第0列数据
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1">//显示进车时间
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">		<span class="nx">TiXmlElement</span> <span class="o">*</span><span class="nx">DateElement</span> <span class="o">=</span> <span class="nx">NameElement</span><span class="o">-&gt;</span><span class="nx">NextSiblingElement</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="kr">const</span> <span class="kr">char</span> <span class="o">*</span><span class="nx">temp</span> <span class="o">=</span> <span class="nx">DateElement</span><span class="o">-&gt;&lt;</span><span class="nx">pre</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&#34;code&#34;</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&#34;html&#34;</span><span class="o">&gt;</span><span class="nx">GetText</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">;</span><span class="nx">m_ctllist1</span><span class="p">.</span><span class="nx">SetItemText</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nx">temp</span><span class="p">);</span><span class="c1">//设置列表框第0行第1列数据FirstElement = FirstElement-&gt;NextSiblingElement();}
</span></span></span></code></pre></div><ul>
<li>第四步，（信息查找及修改）添加查找对话框，编辑框添加变量，本例为m_Number 。查找代码如下</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="kr">char</span> <span class="o">*</span><span class="nx">FileNmae</span> <span class="o">=</span> <span class="s2">&#34;res\\Number.xml&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">TiXmlDocument</span> <span class="o">*</span><span class="nx">pDoc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TiXmlDocument</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="nx">pDoc</span><span class="o">-&gt;</span><span class="nx">LoadFile</span><span class="p">(</span><span class="nx">FileNmae</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">TiXmlElement</span> <span class="o">*</span><span class="nx">RootElement</span> <span class="o">=</span> <span class="nx">pDoc</span><span class="o">-&gt;</span><span class="nx">RootElement</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">TiXmlElement</span> <span class="o">*</span><span class="nx">SonElement</span> <span class="o">=</span> <span class="nx">RootElement</span><span class="o">-&gt;</span><span class="nx">FirstChildElement</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">TiXmlElement</span> <span class="o">*</span><span class="nx">NumberElement</span> <span class="o">=</span> <span class="nx">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">TiXmlElement</span> <span class="o">*</span><span class="nx">passWordElement</span> <span class="o">=</span> <span class="nx">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">while</span> <span class="p">(</span><span class="nx">SonElement</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nx">NumberElement</span> <span class="o">=</span> <span class="nx">SonElement</span><span class="o">-&gt;</span><span class="nx">FirstChildElement</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">(</span><span class="nx">NumberElement</span><span class="o">-&gt;</span><span class="nx">GetText</span><span class="p">()</span> <span class="o">==</span> <span class="nx">m_Number</span><span class="p">)</span><span class="c1">//查找成功判断之后
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">			<span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nx">SonElement</span><span class="o">=</span><span class="nx">SonElement</span><span class="o">-&gt;</span><span class="nx">NextSiblingElement</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">信息查找修改代码如下</span><span class="err">，</span><span class="nx">本例为查找用户名为m_Number修改密码为m_PassWord</span><span class="p">.</span><span class="nx">两个变量都为编辑框CString类型</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="kr">char</span> <span class="o">*</span><span class="nx">FileNmae</span> <span class="o">=</span> <span class="s2">&#34;res\\Number.xml&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">TiXmlDocument</span> <span class="o">*</span><span class="nx">pDoc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TiXmlDocument</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="nx">pDoc</span><span class="o">-&gt;</span><span class="nx">LoadFile</span><span class="p">(</span><span class="nx">FileNmae</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">TiXmlElement</span> <span class="o">*</span><span class="nx">RootElement</span> <span class="o">=</span> <span class="nx">pDoc</span><span class="o">-&gt;</span><span class="nx">RootElement</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">TiXmlElement</span> <span class="o">*</span><span class="nx">SonElement</span> <span class="o">=</span> <span class="nx">RootElement</span><span class="o">-&gt;</span><span class="nx">FirstChildElement</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">TiXmlElement</span> <span class="o">*</span><span class="nx">NumberElement</span> <span class="o">=</span> <span class="nx">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="nx">TiXmlElement</span> <span class="o">*</span><span class="nx">passWordElement</span> <span class="o">=</span> <span class="nx">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="k">while</span> <span class="p">(</span><span class="nx">SonElement</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nx">NumberElement</span> <span class="o">=</span> <span class="nx">SonElement</span><span class="o">-&gt;</span><span class="nx">FirstChildElement</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">(</span><span class="nx">NumberElement</span><span class="o">-&gt;</span><span class="nx">GetText</span><span class="p">()</span> <span class="o">==</span> <span class="nx">m_Number</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">				<span class="k">if</span> <span class="p">(</span><span class="nx">IDYES</span> <span class="o">==</span> <span class="nx">MessageBox</span><span class="p">(</span><span class="s2">&#34;该账号已存在，继续操作将覆盖&#34;</span><span class="p">,</span><span class="s2">&#34;是否继续？&#34;</span><span class="p">,</span><span class="nx">MB_YESNO</span><span class="o">|</span><span class="nx">MB_ICONWARNING</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">				<span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">					<span class="nx">passWordElement</span> <span class="o">=</span> <span class="nx">NumberElement</span><span class="o">-&gt;</span><span class="nx">NextSiblingElement</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">					<span class="nx">TiXmlNode</span> <span class="o">*</span><span class="nx">PassWord</span> <span class="o">=</span> <span class="nx">passWordElement</span><span class="o">-&gt;</span><span class="nx">FirstChild</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">					<span class="nx">PassWord</span><span class="o">-&gt;</span><span class="nx">SetValue</span><span class="p">(</span><span class="nx">m_PassWord</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">					<span class="nx">pDoc</span><span class="o">-&gt;</span><span class="nx">SaveFile</span><span class="p">(</span><span class="nx">FileNmae</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">				    <span class="nx">MessageBox</span><span class="p">(</span><span class="s2">&#34;密码修改成功,下次登录生效&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">				<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">					<span class="kr">goto</span> <span class="nx">end</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nx">SonElement</span><span class="o">=</span><span class="nx">SonElement</span><span class="o">-&gt;</span><span class="nx">NextSiblingElement</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">           <span class="p">}</span>
</span></span></code></pre></div><ul>
<li>第五步，信息删除，本例为查找账号名m_Number对该用户进行删除</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="kr">char</span> <span class="o">*</span><span class="nx">FileName</span> <span class="o">=</span> <span class="s2">&#34;res\\Number.xml&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	 <span class="nx">TiXmlDocument</span> <span class="o">*</span><span class="nx">pDoc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TiXmlDocument</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	 <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">pDoc</span><span class="o">-&gt;</span><span class="nx">LoadFile</span><span class="p">(</span><span class="nx">FileName</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	 <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		 <span class="nx">MessageBox</span><span class="p">(</span><span class="s2">&#34;Number.xml文件损坏&#34;</span><span class="p">,</span><span class="s2">&#34;加载失败&#34;</span><span class="p">,</span><span class="nx">MB_OK</span> <span class="o">|</span> <span class="nx">MB_ICONWARNING</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		 <span class="k">return</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	 <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	 <span class="k">else</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	 <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		 <span class="nx">TiXmlElement</span> <span class="o">*</span><span class="nx">RootElement</span> <span class="o">=</span> <span class="nx">pDoc</span><span class="o">-&gt;</span><span class="nx">RootElement</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		 <span class="nx">TiXmlElement</span> <span class="o">*</span><span class="nx">PersonElement</span> <span class="o">=</span> <span class="nx">RootElement</span><span class="o">-&gt;</span><span class="nx">FirstChildElement</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		 <span class="nx">TiXmlElement</span> <span class="o">*</span><span class="nx">NumberElement</span> <span class="o">=</span> <span class="nx">PersonElement</span><span class="o">-&gt;</span><span class="nx">FirstChildElement</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		 <span class="nx">TiXmlElement</span> <span class="o">*</span><span class="nx">PassWordElement</span> <span class="o">=</span> <span class="nx">NumberElement</span><span class="o">-&gt;</span><span class="nx">NextSiblingElement</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		 <span class="k">while</span> <span class="p">(</span><span class="nx">PersonElement</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		 <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			 <span class="nx">NumberElement</span> <span class="o">=</span> <span class="nx">PersonElement</span><span class="o">-&gt;</span><span class="nx">FirstChildElement</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			 <span class="k">if</span> <span class="p">(</span><span class="nx">NumberElement</span><span class="o">-&gt;</span><span class="nx">GetText</span><span class="p">()</span> <span class="o">==</span>  <span class="nx">m_Number</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			 <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">				 <span class="nx">RootElement</span><span class="o">-&gt;</span><span class="nx">RemoveChild</span><span class="p">(</span><span class="nx">PersonElement</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">				 <span class="nx">MessageBox</span><span class="p">(</span><span class="s2">&#34;删除成功&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">				 <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			 <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			 <span class="k">else</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			 <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">				  <span class="nx">PersonElement</span> <span class="o">=</span> <span class="nx">PersonElement</span><span class="o">-&gt;</span><span class="nx">NextSiblingElement</span><span class="p">();</span><span class="c1">//节点后移
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">			 <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		 <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		 <span class="nx">pDoc</span><span class="o">-&gt;</span><span class="nx">SaveFile</span><span class="p">(</span><span class="nx">FileName</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span></code></pre></div><h2 id="结语">结语</h2>
<p>至于统计什么的，就是查找与显示的变异。</p>

    </div>

    
    <ins class="adsbygoogle"
         style="display:block; text-align:center;width: 100%"
         data-ad-client="ca-pub-3208634444966567"
         data-ad-format="fluid"
         data-ad-layout="in-article"
         data-ad-slot="2621880404">
    </ins>
</div>

    </main>

    
    <footer class="footer">
        <div class="container">
            <span>Copyright © 2017-2025 指尖魔法屋. All rights reserved</span>
            <span>POWERED BY thinkBlog · v1.0.0</span>
            <span>网站持续搭建中，感谢关注</span>
            <div class="beian">
                <a href="http://beian.miit.gov.cn/" target="_blank">粤ICP备17055617号</a>
            </div>
        </div>
    </footer>

    
    <script src="https://example.org/js/thinkblog.js"></script>
</body>
</html>
