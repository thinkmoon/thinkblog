<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>毕业设计思路篇(五)之交通流量模拟 | 指尖魔法屋</title>

    
    <meta name="description" content="">
    <meta name="keywords" content="Traffic-Network-Model">

    
    <meta property="og:title" content="毕业设计思路篇(五)之交通流量模拟">
    <meta property="og:description" content="">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://example.org/post/145_%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF%E7%AF%87_%E4%BA%94_%E4%B9%8B%E4%BA%A4%E9%80%9A%E6%B5%81%E9%87%8F%E6%A8%A1%E6%8B%9F/">
    

    
    <link rel="icon" href="https://example.org/favicon.ico">

    
    <link rel="stylesheet" href="https://example.org/css/reset.css">
    <link rel="stylesheet" href="https://example.org/css/github-markdown.css">
    <link rel="stylesheet" href="https://example.org/css/custom.css">
</head>
<body>
    
    
    <nav class="top-menu">
        <div class="container">
            <div class="left">
                <a href="https://example.org/">指尖魔法屋</a>
            </div>
            <ul class="menu">
                <li class="">
                    <a href="https://example.org/">首页</a>
                </li>
                <li class="">
                    <a href="https://example.org/categories/">分类</a>
                </li>
                <li class="">
                    <a href="https://example.org/tags/">标签</a>
                </li>
            </ul>
            <div class="right">
                <a href="/admin" class="admin-link">
                    <span>登录</span>
                </a>
            </div>
        </div>
    </nav>
    

    
    <main>
        
<div class="page-container">
    <div class="container">
        <article class="post">
            <header class="post-header">
                <h1>毕业设计思路篇(五)之交通流量模拟</h1>

                <div class="post-meta">
                    <time datetime="2019-02-11">2019-02-11</time>
                    

                    
                    <span class="category">
                        <a href="https://example.org/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0">
                            学习笔记
                        </a>
                    </span>
                    
                </div>

                
                <div class="post-tags">
                    标签:
                    
                    <a href="https://example.org/tags/traffic-network-model" class="tag">Traffic-Network-Model</a>
                    
                </div>
                
            </header>

            <div class="post-content markdown-body">
                <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">runSimulation</span><span class="p">(</span><span class="n">Graph</span> <span class="o">&amp;</span><span class="n">G</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="1-遍历每条道路">1. 遍历每条道路</h2>
<h2 id="2-遍历该道路的车辆">2. 遍历该道路的车辆</h2>
<h3 id="a-计算特定时间间隔后的位置">a. 计算特定时间间隔后的位置</h3>
<h3 id="b-若应行驶至其他道路">b. 若应行驶至其他道路</h3>
<p>进入对应的路口缓冲区，根据路口类的红绿灯对象判断是否能通行。</p>
<blockquote>
<p>若能通行，则填至目标道路</p>
</blockquote>
<blockquote>
</blockquote>
<blockquote>
<p>若不能，则继续停留在路口缓冲区</p>
</blockquote>
<h3 id="c-若仍停留在原道路">c. 若仍停留在原道路</h3>
<p>改变该车在当前道路的位置。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="nl">road</span><span class="p">:</span><span class="n">G</span><span class="p">.</span><span class="n">m_Road_v</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">auto</span> <span class="n">src</span> <span class="o">=</span> <span class="n">road</span><span class="p">.</span><span class="n">m_queVehicle</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">decltype</span><span class="p">(</span><span class="n">road</span><span class="p">.</span><span class="n">m_queVehicle</span><span class="p">)</span> <span class="n">obj</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">//路内车的遍历
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">src</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">//弹出一辆车
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">            <span class="k">auto</span> <span class="n">it</span> <span class="o">=</span> <span class="n">src</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">src</span><span class="p">.</span><span class="n">pop_front</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// 当车的时间戳小于实际时间时，才模拟运行
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="n">time</span> <span class="o">&lt;</span> <span class="n">SYSTEM_TIME</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="n">it</span><span class="p">.</span><span class="n">fSpec</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">road</span><span class="p">.</span><span class="n">get_Congestion</span><span class="p">()</span> <span class="o">-</span> <span class="mi">20</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3.6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="n">dist</span> <span class="o">=</span> <span class="n">it</span><span class="p">.</span><span class="n">dDistance</span> <span class="o">+</span> <span class="n">it</span><span class="p">.</span><span class="n">fSpec</span> <span class="o">*</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="n">it</span><span class="p">.</span><span class="n">time</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="n">it</span><span class="p">.</span><span class="n">showself</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="c1">//如果车十秒后不在此路
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="n">dist</span> <span class="o">&gt;=</span> <span class="n">road</span><span class="p">.</span><span class="n">m_dLength</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    <span class="c1">//路径擦除
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">                    <span class="k">auto</span> <span class="n">route</span> <span class="o">=</span> <span class="n">it</span><span class="p">.</span><span class="n">queRoute</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    <span class="kt">int</span> <span class="n">site</span> <span class="o">=</span> <span class="n">it</span><span class="p">.</span><span class="n">m_nSiteRoadID</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    <span class="n">route</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    <span class="c1">//如果抵达终点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="p">(</span><span class="n">route</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;it is be shutdown&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                        <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                        <span class="c1">// 否侧没有抵达终点
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                        <span class="c1">//获取所在路和下一条路的ID
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">                        <span class="kt">int</span> <span class="n">next</span> <span class="o">=</span> <span class="n">route</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                        <span class="c1">//判断红绿灯情况
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">                        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">site</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                        <span class="n">G</span><span class="p">.</span><span class="n">m_CrossRoad_v</span><span class="p">[</span><span class="n">site</span><span class="p">].</span><span class="n">m_CTrafficLight_Light</span><span class="p">.</span><span class="n">clock</span><span class="p">(</span><span class="n">SYSTEM_TIME</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                        <span class="c1">//如果可以通行
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">                        <span class="k">if</span> <span class="p">(</span><span class="n">G</span><span class="p">.</span><span class="n">m_CrossRoad_v</span><span class="p">[</span><span class="n">site</span><span class="p">].</span><span class="n">m_CTrafficLight_Light</span><span class="p">.</span><span class="n">getStatus</span><span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="n">m_nSiteRoadID</span><span class="p">,</span> <span class="n">next</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">GREEN</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;绿灯通行:&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                            <span class="n">it</span><span class="p">.</span><span class="n">queRoute</span> <span class="o">=</span> <span class="n">route</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                            <span class="n">it</span><span class="p">.</span><span class="n">dDistance</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                            <span class="n">it</span><span class="p">.</span><span class="n">m_nSiteRoadID</span> <span class="o">=</span> <span class="n">next</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                            <span class="k">auto</span> <span class="o">*</span><span class="n">site_road</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">G</span><span class="p">.</span><span class="n">m_Road_v</span><span class="p">[</span><span class="n">next</span><span class="p">].</span><span class="n">m_queVehicle</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                            <span class="n">site_road</span><span class="o">-&gt;</span><span class="n">push_back</span><span class="p">(</span><span class="n">it</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                            <span class="c1">//如果不能通行
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                            <span class="c1">//将距离置为道路长度，表示正在等候红灯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">                            <span class="n">it</span><span class="p">.</span><span class="n">dDistance</span> <span class="o">=</span> <span class="n">G</span><span class="p">.</span><span class="n">m_Road_v</span><span class="p">[</span><span class="n">it</span><span class="p">.</span><span class="n">m_nSiteRoadID</span><span class="p">].</span><span class="n">m_dLength</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">YELLOW</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;等待红灯&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                            <span class="c1">//车辆塞回去
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">                            <span class="n">obj</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">it</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    <span class="c1">//否则，当车十秒后还在此路时
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    <span class="n">it</span><span class="p">.</span><span class="n">dDistance</span> <span class="o">=</span> <span class="n">dist</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    <span class="n">obj</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">it</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="c1">//否则直接填入
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="n">obj</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">it</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">road</span><span class="p">.</span><span class="n">m_queVehicle</span> <span class="o">=</span> <span class="n">obj</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div>
            </div>

            
            <ins class="adsbygoogle"
                 style="display:block; text-align:center;width: 100%"
                 data-ad-client="ca-pub-3208634444966567"
                 data-ad-format="fluid"
                 data-ad-layout="in-article"
                 data-ad-slot="2621880404">
            </ins>

            
            <div class="copyright-notice">
                <blockquote>
                    <p>版权声明: （https://example.org/post/145_%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF%E7%AF%87_%E4%BA%94_%E4%B9%8B%E4%BA%A4%E9%80%9A%E6%B5%81%E9%87%8F%E6%A8%A1%E6%8B%9F/）本文首发于
                        <a href="https://example.org/post/145_%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF%E7%AF%87_%E4%BA%94_%E4%B9%8B%E4%BA%A4%E9%80%9A%E6%B5%81%E9%87%8F%E6%A8%A1%E6%8B%9F/">指尖魔法屋-毕业设计思路篇(五)之交通流量模拟</a>
                        转载或引用必须申明原指尖魔法屋来源及源地址！
                    </p>
                </blockquote>
            </div>
        </article>
    </div>
</div>

    </main>

    
    <footer class="footer">
        <div class="container">
            <span>Copyright © 2017-2025 指尖魔法屋. All rights reserved</span>
            <span>POWERED BY thinkBlog · v1.0.0</span>
            <span>网站持续搭建中，感谢关注</span>
            <div class="beian">
                <a href="http://beian.miit.gov.cn/" target="_blank">粤ICP备17055617号</a>
            </div>
        </div>
    </footer>

    
    <script src="https://example.org/js/thinkblog.js"></script>
</body>
</html>
