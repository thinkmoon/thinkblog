<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>在Colab上运行DeepfaceLab训练模型 | 指尖魔法屋</title>

    
    <meta name="description" content="利用开源的DeepFaceLab_Colab，在谷歌colab上运行deepfacelab开源项目。实现云GPU训练">
    <meta name="keywords" content="机器学习">

    
    <meta property="og:title" content="在Colab上运行DeepfaceLab训练模型">
    <meta property="og:description" content="利用开源的DeepFaceLab_Colab，在谷歌colab上运行deepfacelab开源项目。实现云GPU训练">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/post/949_%E5%9C%A8colab%E4%B8%8A%E8%BF%90%E8%A1%8Cdeepfacelab%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B/">
    
    <meta property="og:image" content="https://blog.cdn.thinkmoon.cn/2022-04-10/16-11-03">
    

    
    <link rel="icon" href="/favicon.ico">

    
    <link rel="stylesheet" href="/css/reset.css">
    <link rel="stylesheet" href="/css/github-markdown.css">
    <link rel="stylesheet" href="/css/custom.css">
</head>
<body>
    
    
    <nav class="top-menu">
        <div class="container">
            <div class="left">
                <a href="/">指尖魔法屋</a>
            </div>
            <ul class="menu">
                <li class="">
                    <a href="/">首页</a>
                </li>
                <li class="">
                    <a href="/categories/">分类</a>
                </li>
                <li class="">
                    <a href="/tags/">标签</a>
                </li>
            </ul>
            <div class="right">
                <a href="/admin" class="admin-link">
                    <span>登录</span>
                </a>
            </div>
        </div>
    </nav>
    

    
    <main>
        
<div class="article-content">
    <div class="markdown-body">
        <h2 id="环境">环境</h2>
<ol>
<li>Colab：https://colab.research.google.com/</li>
</ol>
<h2 id="利用开源的deepfacelab_colab">利用开源的DeepFaceLab_Colab</h2>
<blockquote>
<p>地址<a href="https://github.com/dream80/DeepFaceLab_Colab">DeepFaceLab_Colab</a></p>
</blockquote>
<h2 id="打开最新版本v5">打开最新版本V5</h2>
<p><a href="https://github.com/dream80/DeepFaceLab_Colab/blob/master/DeepFaceLab_Colab_V5.ipynb">DeepFaceLab_Colab_V5.ipynb</a></p>
<h2 id="操作步骤">操作步骤</h2>
<h3 id="1-挂载谷歌云盘">1. 挂载谷歌云盘</h3>
<p>运行第一步挂载云盘命令，会弹出谷歌云盘授权窗口，点击允许。</p>
<p><img src="https://blog.cdn.thinkmoon.cn/2022-07-09/16-20-55" alt="挂载谷歌云盘"></p>
<h3 id="2-初始化项目">2. 初始化项目</h3>
<p>该命令会在你的谷歌云盘上创建一个DeepFaceLab的文件夹，如果你使用的tensorflow 1还会安装cuda 10</p>
<p><img src="https://blog.cdn.thinkmoon.cn/2022-07-09/16-27-23" alt="初始化项目"></p>
<h3 id="3-准备素材">3. 准备素材</h3>
<p><img src="https://blog.cdn.thinkmoon.cn/2022-07-09/16-28-59" alt="准备素材"></p>
<p>该命令会从demo仓库下载一份示例数据。同时你可以指定上传文件，覆盖对应的素材。</p>
<h3 id="4-安装软件">4. 安装软件</h3>
<p><img src="https://blog.cdn.thinkmoon.cn/2022-07-09/16-31-11" alt="安装软件"></p>
<p>我这里安装的是最新版本，静候安装完成。</p>
<p><img src="https://blog.cdn.thinkmoon.cn/2022-07-09/16-32-43" alt="安装失败"></p>
<p>然后我第一次安装失败了。莫慌，这里只需要重新点一下“重启运行时”重新运行即可。</p>
<p><img src="https://blog.cdn.thinkmoon.cn/2022-07-09/16-34-00" alt="重启运行时"></p>
<p>重启时这里会发生变化</p>
<p><img src="https://blog.cdn.thinkmoon.cn/2022-07-09/16-34-49" alt="重启初始化"></p>
<p>重新执行<code>初始化项目</code>,<code>安装软件</code>这两个命令操作</p>
<h3 id="提取源面部和目标面部">提取源面部和目标面部</h3>
<p><img src="https://blog.cdn.thinkmoon.cn/2022-07-09/16-38-53" alt="提取面部"></p>
<p><img src="https://blog.cdn.thinkmoon.cn/2022-07-09/16-42-11" alt="目标抽取"></p>
<h3 id="开始训练">开始训练</h3>
<p><img src="https://blog.cdn.thinkmoon.cn/2022-07-09/16-43-26" alt="开始训练"></p>
<h2 id="注意事项">注意事项</h2>
<ol>
<li>
<p>colab上面使用的是linux平台，linux平台拥有更好的合成效果</p>
</li>
<li>
<p>训练时，可以直接在谷歌云盘<code>workspace/model</code>中查看最新的训练预览效果。</p>
</li>
<li>
<p>如果挂载的云盘上面已经安装了deepface的时候，可以修改初始化代码，如下：</p>
</li>
</ol>
<blockquote>
<p>一键训练</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">! /opt/bin/nvidia-smi
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">from google.colab import drive
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">drive.mount<span class="o">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">import os 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">root</span> <span class="o">=</span> <span class="s2">&#34;/content/drive/MyDrive/&#34;</span> <span class="c1">#@param {type:&#34;string&#34;}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">%cd <span class="nv">$root</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">deepfacelab</span><span class="o">=</span>os.path.join<span class="o">(</span>root,<span class="s2">&#34;DeepFaceLab&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">workspace</span><span class="o">=</span>os.path.join<span class="o">(</span>deepfacelab,<span class="s2">&#34;workspace&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">deepfacelab_cloab</span><span class="o">=</span>os.path.join<span class="o">(</span>deepfacelab,<span class="s2">&#34;DeepFaceLab_Colab&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#@title 训练模型</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">Model</span> <span class="o">=</span> <span class="s2">&#34;SAEHD&#34;</span> <span class="c1">#@param [&#34;SAEHD&#34;,&#34;AMP&#34;,&#34;Quick96&#34;,&#34;XSeg&#34;]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">%cd <span class="nv">$deepfacelab_cloab</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">!pip install -r requirements-colab.txt  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">cmd</span> <span class="o">=</span> <span class="s2">&#34;main.py train --training-data-src-dir ../workspace/data_src/aligned --training-data-dst-dir ../workspace/data_dst/aligned --model-dir ../workspace/model --model &#34;</span>+Model+<span class="s2">&#34; --no-preview&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">!python <span class="nv">$cmd</span>
</span></span></code></pre></div><ol start="3">
<li>src素材库一定需要各种角度，光线的高清素材，此时训练效果最好</li>
</ol>
<p><img src="https://blog.cdn.thinkmoon.cn/2022-04-10/16-11-03" alt="效果展示"></p>

    </div>

    
    <ins class="adsbygoogle"
         style="display:block; text-align:center;width: 100%"
         data-ad-client="ca-pub-3208634444966567"
         data-ad-format="fluid"
         data-ad-layout="in-article"
         data-ad-slot="2621880404">
    </ins>
</div>

    </main>

    
    <footer class="footer">
        <div class="container">
            <span>Copyright © 2017-2025 指尖魔法屋. All rights reserved</span>
            <span>POWERED BY thinkBlog · v1.0.0</span>
            <span>网站持续搭建中，感谢关注</span>
            <span id="site-timer">本站已顽强运行：计算中...</span>
            <div class="beian">
                <a href="http://beian.miit.gov.cn/" target="_blank">粤ICP备17055617号</a>
            </div>
        </div>
    </footer>

    
    <script src="/js/thinkblog.js"></script>
</body>
</html>
