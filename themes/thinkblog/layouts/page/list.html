{{ define "main" }}
<div class="page-container">
    <div class="container">
        <div class="page-header">
            <h1>{{ if .Title }}{{ .Title }}{{ else }}ÊñáÁ´†ÂàóË°®{{ end }}</h1>
            {{ if .Description }}
            <p class="page-description">{{ .Description }}</p>
            {{ end }}
        </div>

        <div class="blog-posts">
            {{ $pages := .Site.RegularPages }}
            {{ $pageSize := 10 }}
            {{ $currentURL := .RelPermalink }}
            {{ $currentPage := 1 }}
            {{ $afterPage := strings.TrimPrefix "/page/" $currentURL }}
            {{ $trimmed := strings.TrimSuffix "/" $afterPage }}
            {{ if $trimmed }}
                {{ $currentPage = int $trimmed }}
            {{ end }}
            {{ $offset := mul (sub $currentPage 1) $pageSize }}
            {{ range $index, $element := $pages }}
                {{ if and (ge $index $offset) (lt $index (add $offset $pageSize)) }}
            <article class="content-box">
                {{ if .Params.featured_image }}
                <div class="posts-default-img">
                    <a href="{{ .RelPermalink }}" title="{{ .Title }}">
                        <div class="overlay"></div>
                        <img src="{{ .Params.featured_image }}" alt="{{ .Title }}" loading="lazy">
                    </a>
                </div>
                {{ end }}

                <div class="posts-default-box">
                    <div class="posts-default-title">
                        {{ if .Params.tags }}
                        <div class="post-entry-categories">
                            {{ range .Params.tags }}
                            <a href="/tags/{{ . | urlize }}" class="post-tag">{{ . }}</a>
                            {{ end }}
                        </div>
                        {{ end }}

                        <a href="{{ .RelPermalink }}" class="post-title">
                            {{ .Title }}
                        </a>
                    </div>

                    <div class="posts-default-content">
                        <div class="posts-text">
                            {{ if .Description }}
                                {{ .Description }}
                            {{ else if .Summary }}
                                {{ .Summary }}
                            {{ else }}
                                {{ .Content | plainify | truncate 150 }}
                            {{ end }}
                        </div>

                        <div class="posts-default-info">
                            <div class="left">
                                <div class="post-author">
                                    <img src="{{ .Site.Params.author.avatar }}"
                                         alt="{{ .Site.Params.author.name }}" width="16" height="16" style="border-radius:50%">
                                    <a href="{{ .Site.Params.author.url }}" target="_blank">{{ .Site.Params.author.name }}</a>
                                </div>

                                <div class="ico-warp">
                                    <span class="icon">üìÅ</span>
                                    <a href="/categories/{{ (index (.Params.categories | default (slice "Êú™ÂàÜÁ±ª")) 0) | urlize }}">
                                        {{ index (.Params.categories | default (slice "Êú™ÂàÜÁ±ª")) 0 }}
                                    </a>
                                </div>

                                <div class="ico-warp">
                                    <span class="icon">üìÖ</span>
                                    <span>{{ .Date.Format "2006-01-02" }}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </article>
                {{ end }}
            {{ end }}
        </div>

        {{ $totalPages := div (len (where .Site.RegularPages ".Section" "post")) 10 }}
        {{ if gt (mod (len (where .Site.RegularPages ".Section" "post")) 10) 0 }}
            {{ $totalPages = add $totalPages 1 }}
        {{ end }}

        {{ if gt $totalPages 1 }}
        <div class="pagination-container">
            {{ $maxVisible := 5 }}
            {{ if gt $currentPage 1 }}
            <a href="/page/{{ sub $currentPage 1 }}/" class="pagination-link prev">‰∏ä‰∏ÄÈ°µ</a>
            {{ else }}
            <span class="pagination-link prev disabled">‰∏ä‰∏ÄÈ°µ</span>
            {{ end }}
            {{ if le $totalPages $maxVisible }}
                {{ range $i := (seq 1 $totalPages) }}
                <a href="/page/{{ $i }}/" class="pagination-link {{ if eq $i $currentPage }}active{{ end }}">{{ $i }}</a>
                {{ end }}
            {{ else }}
                {{ if le $currentPage 3 }}
                    {{ range $i := (seq 1 4) }}
                    <a href="/page/{{ $i }}/" class="pagination-link {{ if eq $i $currentPage }}active{{ end }}">{{ $i }}</a>
                    {{ end }}
                    {{ if gt $totalPages 4 }}
                    <span class="pagination-link disabled">...</span>
                    <a href="/page/{{ $totalPages }}/" class="pagination-link">{{ $totalPages }}</a>
                    {{ end }}
                {{ else if ge $currentPage (sub $totalPages 2) }}
                    <a href="/page/" class="pagination-link">1</a>
                    <span class="pagination-link disabled">...</span>
                    {{ range $i := (seq (sub $totalPages 3) $totalPages) }}
                    <a href="/page/{{ $i }}/" class="pagination-link {{ if eq $i $currentPage }}active{{ end }}">{{ $i }}</a>
                    {{ end }}
                {{ else }}
                    <a href="/page/" class="pagination-link">1</a>
                    <span class="pagination-link disabled">...</span>
                    {{ range $i := (seq (sub $currentPage 1) (add $currentPage 1)) }}
                    <a href="/page/{{ $i }}/" class="pagination-link {{ if eq $i $currentPage }}active{{ end }}">{{ $i }}</a>
                    {{ end }}
                    <span class="pagination-link disabled">...</span>
                    <a href="/page/{{ $totalPages }}/" class="pagination-link">{{ $totalPages }}</a>
                {{ end }}
            {{ end }}

            {{ if lt $currentPage $totalPages }}
            <a href="/page/{{ add $currentPage 1 }}/" class="pagination-link next">‰∏ã‰∏ÄÈ°µ</a>
            {{ else }}
            <span class="pagination-link next disabled">‰∏ã‰∏ÄÈ°µ</span>
            {{ end }}
        </div>
        {{ end }}
    </div>
</div>
{{ end }}