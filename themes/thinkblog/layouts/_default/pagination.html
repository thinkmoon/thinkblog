{{ define "main" }}
<div class="page-container">
    <div class="container">
        <div class="page-header">
            <h1>{{ if .Paginator.PageNumber }}{{ printf "Á¨¨%dÈ°µ" .Paginator.PageNumber }}{{ else }}ÊúÄÊñ∞ÊñáÁ´†{{ end }}</h1>
            {{ if .Description }}
            <p class="page-description">{{ .Description }}</p>
            {{ end }}
        </div>

        <div class="blog-posts">
            {{ range .Paginator.Pages }}
            <article class="content-box">
                {{ if .Params.featured_image }}
                <div class="posts-default-img">
                    <a href="{{ .RelPermalink }}" title="{{ .Title }}">
                        <div class="overlay"></div>
                        <img src="{{ .Params.featured_image }}" alt="{{ .Title }}" loading="lazy">
                    </a>
                </div>
                {{ end }}

                <div class="posts-default-box">
                    <div class="posts-default-title">
                        {{ if .Params.tags }}
                        <div class="post-entry-categories">
                            {{ range .Params.tags }}
                            <a href="/tags/{{ . | urlize }}" class="post-tag">{{ . }}</a>
                            {{ end }}
                        </div>
                        {{ end }}

                        <a href="{{ .RelPermalink }}" class="post-title">
                            {{ .Title }}
                        </a>
                    </div>

                    <div class="posts-default-content">
                        <div class="posts-text">
                            {{ if .Description }}
                                {{ .Description }}
                            {{ else if .Summary }}
                                {{ .Summary }}
                            {{ else }}
                                {{ .Content | plainify | truncate 150 }}
                            {{ end }}
                        </div>

                        <div class="posts-default-info">
                            <div class="left">
                                <div class="post-author">
                                    <img src="{{ .Site.Params.author.avatar }}"
                                     alt="{{ .Site.Params.author.name }}" width="16" height="16" style="border-radius:50%">
                                    <a href="{{ .Site.Params.author.url }}" target="_blank">{{ .Site.Params.author.name }}</a>
                                </div>

                                <div class="ico-warp">
                                    <span class="icon">üìÅ</span>
                                    <a href="/categories/{{ (index (.Params.categories | default (slice "Êú™ÂàÜÁ±ª")) 0) | urlize }}">
                                        {{ index (.Params.categories | default (slice "Êú™ÂàÜÁ±ª")) 0 }}
                                    </a>
                                </div>

                                <div class="ico-warp">
                                    <span class="icon">üìÖ</span>
                                    <span>{{ .Date.Format "2006-01-02" }}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </article>
            {{ end }}
        </div>

        {{ if .Paginator }}
        <div class="pagination-div">
            <div class="pagination-container">
                {{ if .Paginator.HasPrev }}
                <a href="{{ .Paginator.Prev.URL }}" class="pagination-item">
                    ‰∏ä‰∏ÄÈ°µ
                </a>
                {{ end }}

                {{ $currentPage := .Paginator.PageNumber }}
                {{ $totalPages := .Paginator.TotalPages }}
                {{ $maxVisible := 5 }}

                {{ if le $totalPages $maxVisible }}
                    <!-- Â¶ÇÊûúÊÄªÈ°µÊï∞Â∞è‰∫éÁ≠â‰∫éÊúÄÂ§ßÊòæÁ§∫Êï∞ÔºåÊòæÁ§∫ÊâÄÊúâÈ°µÁ†Å -->
                    {{ range $i := (seq 1 $totalPages) }}
                    <a href="{{ printf "/page/%d" $i }}"
                       class="pagination-item {{ if eq $i $currentPage }}is-active{{ end }}">
                        {{ $i }}
                    </a>
                    {{ end }}
                {{ else }}
                    <!-- ÂßãÁªàÊòæÁ§∫Á¨¨‰∏ÄÈ°µ -->
                    <a href="{{ "/page/1" }}" class="pagination-item {{ if eq $currentPage 1 }}is-active{{ end }}">
                        1
                    </a>

                    {{ $start := sub $currentPage 1 }}
                    {{ if lt $start 2 }}
                        {{ $start = 2 }}
                    {{ end }}
                    {{ $end := add $currentPage 1 }}
                    {{ if gt $end (sub $totalPages 1) }}
                        {{ $end = sub $totalPages 1 }}
                    {{ end }}

                    {{ if lt $currentPage 4 }}
                        {{ $start = 2 }}
                        {{ $end = 4 }}
                    {{ else if gt $currentPage (sub $totalPages 3) }}
                        {{ $start = sub $totalPages 3 }}
                        {{ $end = sub $totalPages 1 }}
                    {{ end }}

                    <!-- Ê∑ªÂä†ÁúÅÁï•Âè∑ -->
                    {{ if gt $start 2 }}
                    <span class="pagination-item is-disabled">...</span>
                    {{ end }}

                    <!-- Ê∑ªÂä†‰∏≠Èó¥È°µÁ†Å -->
                    {{ range $i := (seq $start $end) }}
                    <a href="{{ printf "/page/%d" $i }}"
                       class="pagination-item {{ if eq $i $currentPage }}is-active{{ end }}">
                        {{ $i }}
                    </a>
                    {{ end }}

                    <!-- Ê∑ªÂä†ÁúÅÁï•Âè∑ -->
                    {{ if lt $end (sub $totalPages 1) }}
                    <span class="pagination-item is-disabled">...</span>
                    {{ end }}

                    <!-- ÂßãÁªàÊòæÁ§∫ÊúÄÂêé‰∏ÄÈ°µ -->
                    <a href="{{ printf "/page/%d" $totalPages }}"
                       class="pagination-item {{ if eq $currentPage $totalPages }}is-active{{ end }}">
                        {{ $totalPages }}
                    </a>
                {{ end }}

                {{ if .Paginator.HasNext }}
                <a href="{{ .Paginator.Next.URL }}" class="pagination-item">
                    ‰∏ã‰∏ÄÈ°µ
                </a>
                {{ end }}
            </div>
        </div>
        {{ end }}
    </div>
</div>
{{ end }}
